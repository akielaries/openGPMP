\hypertarget{classRC4}{}\doxysection{RC4 Class Reference}
\label{classRC4}\index{RC4@{RC4}}


{\ttfamily \#include $<$rc4.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classRC4_adaf2482857cea29d3e872621a80cb8cb}{byte\+\_\+swap}} (uint8\+\_\+t $\ast$a, uint8\+\_\+t $\ast$b)
\item 
void \mbox{\hyperlink{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}{trad\+\_\+swap}} (unsigned char $\ast$a, unsigned char $\ast$b)
\item 
void \mbox{\hyperlink{classRC4_a857f76dfb7b22916ad210891f8818104}{XOR\+\_\+swap}} (unsigned char $\ast$a, unsigned char $\ast$b)
\item 
void \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA}} (char $\ast$key, unsigned char $\ast$S, int swap\+\_\+type)
\item 
void \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA}} (unsigned char $\ast$S, char $\ast$plaintext, unsigned char $\ast$ciphertext, int swap\+\_\+type)
\item 
std\+::string \mbox{\hyperlink{classRC4_a8925d178acbb55053cc58aa10206e135}{store\+\_\+hash}} (char $\ast$plaintext, unsigned char $\ast$hashtext, int swap\+\_\+type)
\item 
unsigned char $\ast$ \mbox{\hyperlink{classRC4_af3943e593ed70b833b3045cf0c9f3c55}{compute}} (char $\ast$key, char $\ast$plaintext, unsigned char $\ast$hashtext, int swap\+\_\+type)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{rc4_8hpp_source_l00017}{17}} of file \mbox{\hyperlink{rc4_8hpp_source}{rc4.\+hpp}}.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classRC4_adaf2482857cea29d3e872621a80cb8cb}\label{classRC4_adaf2482857cea29d3e872621a80cb8cb}} 
\index{RC4@{RC4}!byte\_swap@{byte\_swap}}
\index{byte\_swap@{byte\_swap}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{byte\_swap()}{byte\_swap()}}
{\footnotesize\ttfamily void RC4\+::byte\+\_\+swap (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{a,  }\item[{uint8\+\_\+t $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00018}{18}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00018                                           \{}
\DoxyCodeLine{00019     uint8\_t swapped = * a;}
\DoxyCodeLine{00020     swapped = *a;}
\DoxyCodeLine{00021     *a = *b;}
\DoxyCodeLine{00022     *b = swapped;}
\DoxyCodeLine{00023 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA()}}, and \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA()}}.

\mbox{\Hypertarget{classRC4_af3943e593ed70b833b3045cf0c9f3c55}\label{classRC4_af3943e593ed70b833b3045cf0c9f3c55}} 
\index{RC4@{RC4}!compute@{compute}}
\index{compute@{compute}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{compute()}{compute()}}
{\footnotesize\ttfamily unsigned char $\ast$ RC4\+::compute (\begin{DoxyParamCaption}\item[{char $\ast$}]{key,  }\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{hashtext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00122}{122}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00125                                \{}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127     \textcolor{keywordflow}{if} (ciphertext == NULL) \{}
\DoxyCodeLine{00128         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}[-\/] Error Allocating Memory"{}});}
\DoxyCodeLine{00129     \}}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131     \textcolor{comment}{// check for swap types 1-\/3}}
\DoxyCodeLine{00132     \textcolor{keywordflow}{if} (0 <= swap\_type \&\& swap\_type <= 2) \{}
\DoxyCodeLine{00133         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} S[\mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}];}
\DoxyCodeLine{00134         \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA}}(key, S, swap\_type);}
\DoxyCodeLine{00135         \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA}}(S, plaintext, ciphertext, swap\_type);}
\DoxyCodeLine{00136     \}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type > 2) \{}
\DoxyCodeLine{00139         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}[-\/] Invalid swap\_type"{}});}
\DoxyCodeLine{00140     \}}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142     \textcolor{keywordflow}{return} ciphertext;}
\DoxyCodeLine{00143 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\+\_\+\+LIMIT}}, \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA()}}, and \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA()}}.

\mbox{\Hypertarget{classRC4_a8d0de8b7bdf64701875569ea90309310}\label{classRC4_a8d0de8b7bdf64701875569ea90309310}} 
\index{RC4@{RC4}!KSA@{KSA}}
\index{KSA@{KSA}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{KSA()}{KSA()}}
{\footnotesize\ttfamily void RC4\+::\+KSA (\begin{DoxyParamCaption}\item[{char $\ast$}]{key,  }\item[{unsigned char $\ast$}]{S,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00037}{37}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00039                                \{}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00041     uint32\_t len = strlen(key);}
\DoxyCodeLine{00042     \textcolor{keywordtype}{int} j = 0;}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}; i++) \{}
\DoxyCodeLine{00045         S[i] = i;}
\DoxyCodeLine{00046     \}}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\_LIMIT}}; i++) \{}
\DoxyCodeLine{00049         j = (j + S[i] + key[i \% len]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051         \textcolor{comment}{// choose swap algorithm based off swap\_type}}
\DoxyCodeLine{00052         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00053             \mbox{\hyperlink{classRC4_a857f76dfb7b22916ad210891f8818104}{XOR\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00054         \}}
\DoxyCodeLine{00055         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 1) \{}
\DoxyCodeLine{00056             \mbox{\hyperlink{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}{trad\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00057         \}}
\DoxyCodeLine{00058         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 2) \{}
\DoxyCodeLine{00059             \mbox{\hyperlink{classRC4_adaf2482857cea29d3e872621a80cb8cb}{byte\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00060         \}}
\DoxyCodeLine{00061     \}}
\DoxyCodeLine{00062 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}, \mbox{\hyperlink{rc4_8hpp_aea95cbd2fc2a755e5fd8230fda5bac47}{BYTE\+\_\+\+LIMIT}}, \mbox{\hyperlink{classRC4_adaf2482857cea29d3e872621a80cb8cb}{byte\+\_\+swap()}}, \mbox{\hyperlink{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}{trad\+\_\+swap()}}, and \mbox{\hyperlink{classRC4_a857f76dfb7b22916ad210891f8818104}{XOR\+\_\+swap()}}.



Referenced by \mbox{\hyperlink{classRC4_af3943e593ed70b833b3045cf0c9f3c55}{compute()}}.

\mbox{\Hypertarget{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}\label{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}} 
\index{RC4@{RC4}!PRGA@{PRGA}}
\index{PRGA@{PRGA}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{PRGA()}{PRGA()}}
{\footnotesize\ttfamily void RC4\+::\+PRGA (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{S,  }\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{ciphertext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00064}{64}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00067                                \{}
\DoxyCodeLine{00068     }
\DoxyCodeLine{00069     \textcolor{keywordtype}{int} i = 0;}
\DoxyCodeLine{00070     \textcolor{keywordtype}{int} j = 0;}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} n = 0, len = strlen(plaintext); n < len; n++) \{}
\DoxyCodeLine{00073         i = (i + 1) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00074         j = (j + S[i]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}};}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076         \textcolor{comment}{// choose swap algorithm based off swap\_type}}
\DoxyCodeLine{00077         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00078             \mbox{\hyperlink{classRC4_a857f76dfb7b22916ad210891f8818104}{XOR\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00079         \}}
\DoxyCodeLine{00080         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 1) \{}
\DoxyCodeLine{00081             \mbox{\hyperlink{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}{trad\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00082         \}}
\DoxyCodeLine{00083         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (swap\_type == 2) \{}
\DoxyCodeLine{00084             \mbox{\hyperlink{classRC4_adaf2482857cea29d3e872621a80cb8cb}{byte\_swap}}(\&S[i], \&S[j]);}
\DoxyCodeLine{00085         \}}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087         uint32\_t rnd = S[(S[i] + S[j]) \& \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}];}
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089         ciphertext[n] = rnd \string^ plaintext[n];}
\DoxyCodeLine{00090     \}}
\DoxyCodeLine{00091 \}}

\end{DoxyCode}


References \mbox{\hyperlink{rc4_8hpp_a9d2a7c69bd3fabc41e1ee87df2f283b3}{BITS}}, \mbox{\hyperlink{classRC4_adaf2482857cea29d3e872621a80cb8cb}{byte\+\_\+swap()}}, \mbox{\hyperlink{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}{trad\+\_\+swap()}}, and \mbox{\hyperlink{classRC4_a857f76dfb7b22916ad210891f8818104}{XOR\+\_\+swap()}}.



Referenced by \mbox{\hyperlink{classRC4_af3943e593ed70b833b3045cf0c9f3c55}{compute()}}.

\mbox{\Hypertarget{classRC4_a8925d178acbb55053cc58aa10206e135}\label{classRC4_a8925d178acbb55053cc58aa10206e135}} 
\index{RC4@{RC4}!store\_hash@{store\_hash}}
\index{store\_hash@{store\_hash}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{store\_hash()}{store\_hash()}}
{\footnotesize\ttfamily std\+::string RC4\+::store\+\_\+hash (\begin{DoxyParamCaption}\item[{char $\ast$}]{plaintext,  }\item[{unsigned char $\ast$}]{hashtext,  }\item[{int}]{swap\+\_\+type }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00093}{93}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00095                                \{}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097     \textcolor{comment}{// length of our plaintext}}
\DoxyCodeLine{00098     \textcolor{keywordtype}{int} len = strlen((\textcolor{keywordtype}{char}*)plaintext);}
\DoxyCodeLine{00099     \textcolor{comment}{// for snprintf declare a buffer}}
\DoxyCodeLine{00100     \textcolor{keywordtype}{char} buffer[len + 1];}
\DoxyCodeLine{00101     \textcolor{keywordtype}{int} size = \textcolor{keyword}{sizeof}(buffer);}
\DoxyCodeLine{00102     }
\DoxyCodeLine{00103     \textcolor{comment}{// initialize empty string}}
\DoxyCodeLine{00104     std::string stored\_text = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00105     }
\DoxyCodeLine{00106     \textcolor{comment}{// traverse the hashtext appending each block to a string}}
\DoxyCodeLine{00107     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} index = 0, len = strlen(plaintext); }
\DoxyCodeLine{00108                             index < len; index++) \{}
\DoxyCodeLine{00109         \textcolor{keywordflow}{if} (swap\_type == 0) \{}
\DoxyCodeLine{00110             snprintf(buffer, size, \textcolor{stringliteral}{"{}|x\%02hhx|"{}}, hashtext[index]);}
\DoxyCodeLine{00111         \}}
\DoxyCodeLine{00112         \textcolor{comment}{// to format our hash to a string for future manipulation}}
\DoxyCodeLine{00113         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00114             snprintf(buffer, size, \textcolor{stringliteral}{"{}\%02hhX"{}}, hashtext[index]);}
\DoxyCodeLine{00115         \}}
\DoxyCodeLine{00116         \textcolor{comment}{// append the declared string}}
\DoxyCodeLine{00117         stored\_text += std::string(buffer);}
\DoxyCodeLine{00118     \}}
\DoxyCodeLine{00119     \textcolor{keywordflow}{return} stored\_text;}
\DoxyCodeLine{00120 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}\label{classRC4_a9eed557512a32f5eaf97f65cd31cabd1}} 
\index{RC4@{RC4}!trad\_swap@{trad\_swap}}
\index{trad\_swap@{trad\_swap}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{trad\_swap()}{trad\_swap()}}
{\footnotesize\ttfamily void RC4\+::trad\+\_\+swap (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{a,  }\item[{unsigned char $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00025}{25}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00025                                                       \{}
\DoxyCodeLine{00026     \textcolor{keywordtype}{int} swapped = *a;}
\DoxyCodeLine{00027     *a = *b;}
\DoxyCodeLine{00028     *b = swapped;}
\DoxyCodeLine{00029 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA()}}, and \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA()}}.

\mbox{\Hypertarget{classRC4_a857f76dfb7b22916ad210891f8818104}\label{classRC4_a857f76dfb7b22916ad210891f8818104}} 
\index{RC4@{RC4}!XOR\_swap@{XOR\_swap}}
\index{XOR\_swap@{XOR\_swap}!RC4@{RC4}}
\doxysubsubsection{\texorpdfstring{XOR\_swap()}{XOR\_swap()}}
{\footnotesize\ttfamily void RC4\+::\+XOR\+\_\+swap (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{a,  }\item[{unsigned char $\ast$}]{b }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{rc4_8cpp_source_l00031}{31}} of file \mbox{\hyperlink{rc4_8cpp_source}{rc4.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00031                                                      \{}
\DoxyCodeLine{00032     *a \string^= *b;}
\DoxyCodeLine{00033     *b \string^= *a;}
\DoxyCodeLine{00034     *a \string^= *b;}
\DoxyCodeLine{00035 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{classRC4_a8d0de8b7bdf64701875569ea90309310}{KSA()}}, and \mbox{\hyperlink{classRC4_a65e83a2f7ff67b6f1da40958a84bf549}{PRGA()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/number\+\_\+theory/\mbox{\hyperlink{rc4_8hpp}{rc4.\+hpp}}\item 
modules/number\+\_\+theory/\mbox{\hyperlink{rc4_8cpp}{rc4.\+cpp}}\end{DoxyCompactItemize}
