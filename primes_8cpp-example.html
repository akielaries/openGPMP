<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>openMTPK: primes.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeDarkModeToggle.title = "Toggle Light/Dark Mode"
    DoxygenAwesomeDarkModeToggle.lightModeIcon = 'ðŸŒž'
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="openMTPK_icon_smaller.png"/></td>
  <td id="projectalign">
   <div id="projectname">openMTPK
   </div>
   <div id="projectbrief">Open Source Mathematics Package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">primes.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Driver for showing how to use the core functionalities of the Number Theory module by itself as well as with the openMTPK ThreadPool. This features functions related to primes specifically generation and testing.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openMTPK/core/threadpool.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openMTPK/nt/prime_gen.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openMTPK/nt/prime_test.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a name="a0"></a><a class="code" href="primes_8cpp.html#a14003875a6c31e1f9d1bf4b153878e3e">testing_miller</a>(std::vector&lt;int64_t&gt; nums) {</div>
<div class="line">    <span class="comment">/* SEQUENTIAL MILLER-RABIN TEST */</span></div>
<div class="line">    std::chrono::steady_clock::time_point start_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">    <a name="_a1"></a><a class="code" href="classmtpk_1_1PrimalityTest.html">mtpk::PrimalityTest</a> prims;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Miller-Rabin sequentially without ThreadPool&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint64_t n : nums) {</div>
<div class="line">        <span class="keywordflow">if</span> (prims.<a name="a2"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#aea296e7913cb51cc89c3b79fcf737194">miller_rabin_prime</a>(n, 120000))</div>
<div class="line">            std::cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; is prime&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            std::cout &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; is composite&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::chrono::steady_clock::time_point end_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Time elapsed: &quot;</span></div>
<div class="line">              &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                     end_time - start_time)</div>
<div class="line">                     .count()</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a name="a3"></a><a class="code" href="primes_8cpp.html#a33daa0145dde696a317ebf44cde84295">testing_miller_thread</a>(std::vector&lt;int64_t&gt; nums) {</div>
<div class="line">    <span class="comment">/* MILLER-RABIN TEST USING THREADPOOL WITH MANUAL ENQUEUE */</span></div>
<div class="line">    std::chrono::steady_clock::time_point start_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// declares a threadpool with 4 threads</span></div>
<div class="line">    <a name="_a4"></a><a class="code" href="classmtpk_1_1core_1_1ThreadPool.html">mtpk::core::ThreadPool</a> *pool = <span class="keyword">new</span> <a class="code" href="classmtpk_1_1core_1_1ThreadPool.html">mtpk::core::ThreadPool</a>(4);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;std::future&lt;bool&gt;&gt; miller_results;</div>
<div class="line">    <a class="code" href="classmtpk_1_1PrimalityTest.html">mtpk::PrimalityTest</a> <a name="a5"></a><a class="code" href="prime__test_8cpp.html#ae705b16e0f91ad04a0d1892bd85d3b5b">prim</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : nums) {</div>
<div class="line">        miller_results.emplace_back(pool-&gt;<a name="a6"></a><a class="code" href="classmtpk_1_1core_1_1ThreadPool.html#a74055a560f9b8a2937ccbd652eb8b8a8">enqueue</a>(</div>
<div class="line">            [&amp;<a class="code" href="prime__test_8cpp.html#ae705b16e0f91ad04a0d1892bd85d3b5b">prim</a>, n]() { return prim.miller_rabin_prime(n, 120000); }));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print the results</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\nResults:\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Miller-Rabin with ThreadPool&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; miller_results.size(); i++) {</div>
<div class="line">        <span class="keywordtype">bool</span> is_prime = miller_results[i].get();</div>
<div class="line">        std::cout &lt;&lt; nums[i] &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; (is_prime ? <span class="stringliteral">&quot;prime&quot;</span> : <span class="stringliteral">&quot;composite&quot;</span>)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">delete</span> pool;</div>
<div class="line"> </div>
<div class="line">    std::chrono::steady_clock::time_point end_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Time elapsed: &quot;</span></div>
<div class="line">              &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                     end_time - start_time)</div>
<div class="line">                     .count()</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a name="a7"></a><a class="code" href="primes_8cpp.html#a286bd143d8ec3bf5f09b6dc36803c093">testing_new_miller</a>(std::vector&lt;int64_t&gt; nums) {</div>
<div class="line">    <span class="comment">/* MILLER-RABIN USING THREADPOOL DISPATCH UTILITY FUNCTION */</span></div>
<div class="line">    std::chrono::steady_clock::time_point start_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line">    <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;std::future&lt;bool&gt;&gt; miller_results;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classmtpk_1_1PrimalityTest.html">mtpk::PrimalityTest</a> <a class="code" href="prime__test_8cpp.html#ae705b16e0f91ad04a0d1892bd85d3b5b">prim</a>;</div>
<div class="line">    <a class="code" href="classmtpk_1_1core_1_1ThreadPool.html">mtpk::core::ThreadPool</a> *pool = <span class="keyword">new</span> <a class="code" href="classmtpk_1_1core_1_1ThreadPool.html">mtpk::core::ThreadPool</a>(4);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : nums) {</div>
<div class="line">        <span class="comment">// enqueue the function call to the thread pool using the</span></div>
<div class="line">        <span class="comment">// ThreadDispatch.dispatch() function</span></div>
<div class="line">        miller_results.emplace_back(<a name="_a8"></a><a class="code" href="classmtpk_1_1core_1_1ThreadDispatch.html">mtpk::core::ThreadDispatch</a>().<a name="a9"></a><a class="code" href="c__threadpool_8c.html#a40f3db62ccfd7fdffb7624bb565ba425">dispatch</a>(</div>
<div class="line">            *pool, &amp;<a class="code" href="classmtpk_1_1PrimalityTest.html#aea296e7913cb51cc89c3b79fcf737194">mtpk::PrimalityTest::miller_rabin_prime</a>, &amp;<a class="code" href="prime__test_8cpp.html#ae705b16e0f91ad04a0d1892bd85d3b5b">prim</a>, n, 120000));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Print the results</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\nResults:\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Miller-Rabin with ThreadPool using ThreadDispatch.dispatch()&quot;</span></div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; miller_results.size(); i++) {</div>
<div class="line">        <span class="keywordtype">bool</span> is_prime = miller_results[i].get();</div>
<div class="line">        std::cout &lt;&lt; nums[i] &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; (is_prime ? <span class="stringliteral">&quot;prime&quot;</span> : <span class="stringliteral">&quot;composite&quot;</span>)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">delete</span> pool;</div>
<div class="line"> </div>
<div class="line">    std::chrono::steady_clock::time_point end_time =</div>
<div class="line">        std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Time elapsed: &quot;</span></div>
<div class="line">              &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                     end_time - start_time)</div>
<div class="line">                     .count()</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a name="a10"></a><a class="code" href="primes_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;BASIC NUMBER THEORY OPERATIONS\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="comment">// declare primality class object</span></div>
<div class="line">    <a class="code" href="classmtpk_1_1PrimalityTest.html">mtpk::PrimalityTest</a> p;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;--------- IS IT PRIME? ---------&gt;\n&quot;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> a = 9;</div>
<div class="line">    <span class="comment">// check if an integer is prime or not</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_it = p.<a name="a11"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#afbdde3f21b4bc18dc88e891a2caeb8b5">is_prime</a>(a);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; is prime? : &quot;</span>;</div>
<div class="line">    is_it ? std::cout &lt;&lt; <span class="stringliteral">&quot;true\n&quot;</span> : std::cout &lt;&lt; <span class="stringliteral">&quot;false\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> b = 2;</div>
<div class="line">    <span class="keywordtype">bool</span> is_it2 = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#afbdde3f21b4bc18dc88e891a2caeb8b5">is_prime</a>(b);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; is prime? : &quot;</span>;</div>
<div class="line">    is_it2 ? std::cout &lt;&lt; <span class="stringliteral">&quot;true\n&quot;</span> : std::cout &lt;&lt; <span class="stringliteral">&quot;false\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;--------- MILLER-RABIN METHOD ---------&gt;\n&quot;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> min_num = 1;</div>
<div class="line">    <span class="comment">// display the prime numbers smaller than a given value</span></div>
<div class="line">    <span class="keywordtype">int</span> max_num = 100;</div>
<div class="line">    <span class="comment">// number of iterations</span></div>
<div class="line">    <span class="keywordtype">int</span> iters = 4;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * calculate the solution, the method doesn&#39;t return a value,</span></div>
<div class="line"><span class="comment">     * prints the values</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    p.<a name="a12"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#a0923c2f17fd016ef13468cb59013581e">miller_rabin</a>(iters, min_num, max_num);</div>
<div class="line">    p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a0923c2f17fd016ef13468cb59013581e">miller_rabin</a>(iters, 25, 50);</div>
<div class="line">    p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a0923c2f17fd016ef13468cb59013581e">miller_rabin</a>(iters, 30, 3000);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;--------- CARMICHAEL NUMBERS ---------&gt;\n&quot;</span>;</div>
<div class="line">    <span class="keywordtype">int</span> cm_test = 500;</div>
<div class="line">    <span class="keywordtype">bool</span> carm_num = p.<a name="a13"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#a3075a71884ea6c4d7dee3a60ccba0ef1">carmichael_num</a>(cm_test);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> cm_test1 = 561;</div>
<div class="line">    <span class="keywordtype">bool</span> carm_num1 = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a3075a71884ea6c4d7dee3a60ccba0ef1">carmichael_num</a>(cm_test1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> cm_test2 = 1105;</div>
<div class="line">    <span class="keywordtype">bool</span> carm_num2 = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a3075a71884ea6c4d7dee3a60ccba0ef1">carmichael_num</a>(cm_test2);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; cm_test &lt;&lt; <span class="stringliteral">&quot; is a carmichael number : &quot;</span>;</div>
<div class="line">    carm_num ? std::cout &lt;&lt; <span class="stringliteral">&quot;true\n&quot;</span> : std::cout &lt;&lt; <span class="stringliteral">&quot;false\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; cm_test1 &lt;&lt; <span class="stringliteral">&quot; is a carmichael number : &quot;</span>;</div>
<div class="line">    carm_num1 ? std::cout &lt;&lt; <span class="stringliteral">&quot;true\n&quot;</span> : std::cout &lt;&lt; <span class="stringliteral">&quot;false\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; cm_test2 &lt;&lt; <span class="stringliteral">&quot; is a carmichael number : &quot;</span>;</div>
<div class="line">    carm_num2 ? std::cout &lt;&lt; <span class="stringliteral">&quot;true\n&quot;</span> : std::cout &lt;&lt; <span class="stringliteral">&quot;false\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Power Modulo function</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordtype">int</span> pow_a = 3;</div>
<div class="line">    <span class="keywordtype">int</span> pow_b = 2;</div>
<div class="line">    <span class="keywordtype">int</span> pow_c = 2;</div>
<div class="line">    <span class="comment">// returns (a^b) % c</span></div>
<div class="line">    <span class="keywordtype">int</span> pow_res = p.<a name="a14"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#a6fed0cc0fb9ae1f51b1eb6338486fbb9">mod_pow</a>(pow_a, pow_b, pow_c);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%d ^ %d %% %d = %d\n&quot;</span>, pow_a, pow_b, pow_c, pow_res);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> pow_d = 5;</div>
<div class="line">    <span class="keywordtype">int</span> pow_e = 2;</div>
<div class="line">    <span class="keywordtype">int</span> pow_f = 7;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> pow_res_1 = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a6fed0cc0fb9ae1f51b1eb6338486fbb9">mod_pow</a>(pow_d, pow_e, pow_f);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%d ^ %d %% %d = %d\n&quot;</span>, pow_d, pow_e, pow_f, pow_res_1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> pow_g = 8;</div>
<div class="line">    <span class="keywordtype">int</span> pow_h = 9;</div>
<div class="line">    <span class="keywordtype">int</span> pow_i = 3;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> pow_res_2 = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#a6fed0cc0fb9ae1f51b1eb6338486fbb9">mod_pow</a>(pow_g, pow_h, pow_i);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%d ^ %d %% %d = %d\n&quot;</span>, pow_g, pow_h, pow_i, pow_res_2);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> cmp = p.<a class="code" href="classmtpk_1_1PrimalityTest.html#aea296e7913cb51cc89c3b79fcf737194">miller_rabin_prime</a>(5, 4);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;miller_rabin_prime: &quot;</span> &lt;&lt; cmp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Jacobian</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Solovay-Strassen Primality Test</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordtype">int</span> ss_0 = 15;</div>
<div class="line">    <span class="keywordflow">if</span> (p.<a name="a15"></a><a class="code" href="classmtpk_1_1PrimalityTest.html#a24debb997099c26dc0482647d775dfd5">solovoy_strassen</a>(ss_0, 50))</div>
<div class="line">        printf(<span class="stringliteral">&quot;%d is prime\n&quot;</span>, ss_0);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;%d is composite\n&quot;</span>, ss_0);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// example vector of 64 bit integers</span></div>
<div class="line">    std::vector&lt;int64_t&gt; nums = {</div>
<div class="line">        9223372036854775803,   9223372036854775807,   9223372036854775303,</div>
<div class="line">        4567890123456789LL,    5678901234567890LL,    6789012345678901LL,</div>
<div class="line">        7890123456789012LL,    8901234567890123LL,    9999999967LL,</div>
<div class="line">        12345678901234567LL,   987654321987654321LL,  2147483647LL,</div>
<div class="line">        9223372036854775783LL, 1311768467463790320LL, 7237005577332262210LL,</div>
<div class="line">        3037000499LL,          2305843009213693951LL, 2305843009213693967LL,</div>
<div class="line">        2305843009213693971LL, 2305843009213693973LL, 2305843009213693977LL,</div>
<div class="line">        2305843009213693989LL};</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="primes_8cpp.html#a14003875a6c31e1f9d1bf4b153878e3e">testing_miller</a>(nums);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;&lt;--------- USING THREADPOOL ---------&gt;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="primes_8cpp.html#a33daa0145dde696a317ebf44cde84295">testing_miller_thread</a>(nums);</div>
<div class="line">    <a class="code" href="primes_8cpp.html#a286bd143d8ec3bf5f09b6dc36803c093">testing_new_miller</a>(nums);</div>
<div class="line">    <a class="code" href="primes_8cpp.html#a33daa0145dde696a317ebf44cde84295">testing_miller_thread</a>(nums);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// vector if 64 bit integers</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="ac__threadpool_8c_html_a40f3db62ccfd7fdffb7624bb565ba425"><div class="ttname"><a href="c__threadpool_8c.html#a40f3db62ccfd7fdffb7624bb565ba425">dispatch</a></div><div class="ttdeci">void dispatch(threadpool from_me, dispatch_fn dispatch_to_here, void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="c__threadpool_8c_source.html#l00137">c_threadpool.c:137</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html">mtpk::PrimalityTest</a></div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8hpp_source.html#l00051">prime_test.hpp:51</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_a0923c2f17fd016ef13468cb59013581e"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#a0923c2f17fd016ef13468cb59013581e">mtpk::PrimalityTest::miller_rabin</a></div><div class="ttdeci">void miller_rabin(uint64_t iters, uint64_t min_val, uint64_t max_val)</div><div class="ttdoc">Miller-Rabin driver, prints values that satisfy conditions.</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00209">prime_test.cpp:209</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_a24debb997099c26dc0482647d775dfd5"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#a24debb997099c26dc0482647d775dfd5">mtpk::PrimalityTest::solovoy_strassen</a></div><div class="ttdeci">bool solovoy_strassen(uint64_t p, uint64_t iters)</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00324">prime_test.cpp:324</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_a3075a71884ea6c4d7dee3a60ccba0ef1"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#a3075a71884ea6c4d7dee3a60ccba0ef1">mtpk::PrimalityTest::carmichael_num</a></div><div class="ttdeci">bool carmichael_num(uint64_t n)</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00348">prime_test.cpp:348</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_a6fed0cc0fb9ae1f51b1eb6338486fbb9"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#a6fed0cc0fb9ae1f51b1eb6338486fbb9">mtpk::PrimalityTest::mod_pow</a></div><div class="ttdeci">uint64_t mod_pow(uint64_t a, uint64_t b, uint64_t m)</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00075">prime_test.cpp:75</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_aea296e7913cb51cc89c3b79fcf737194"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#aea296e7913cb51cc89c3b79fcf737194">mtpk::PrimalityTest::miller_rabin_prime</a></div><div class="ttdeci">bool miller_rabin_prime(uint64_t n, uint64_t iters)</div><div class="ttdoc">Modified primes algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00184">prime_test.cpp:184</a></div></div>
<div class="ttc" id="aclassmtpk_1_1PrimalityTest_html_afbdde3f21b4bc18dc88e891a2caeb8b5"><div class="ttname"><a href="classmtpk_1_1PrimalityTest.html#afbdde3f21b4bc18dc88e891a2caeb8b5">mtpk::PrimalityTest::is_prime</a></div><div class="ttdeci">bool is_prime(uint64_t n)</div><div class="ttdoc">Determine if an integer is prime.</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00105">prime_test.cpp:105</a></div></div>
<div class="ttc" id="aclassmtpk_1_1core_1_1ThreadDispatch_html"><div class="ttname"><a href="classmtpk_1_1core_1_1ThreadDispatch.html">mtpk::core::ThreadDispatch</a></div><div class="ttdoc">A class that provides a function to dispatch a function call to a thread pool and return a future obj...</div><div class="ttdef"><b>Definition:</b> <a href="threadpool_8hpp_source.html#l00200">threadpool.hpp:200</a></div></div>
<div class="ttc" id="aclassmtpk_1_1core_1_1ThreadPool_html"><div class="ttname"><a href="classmtpk_1_1core_1_1ThreadPool.html">mtpk::core::ThreadPool</a></div><div class="ttdef"><b>Definition:</b> <a href="threadpool_8hpp_source.html#l00059">threadpool.hpp:59</a></div></div>
<div class="ttc" id="aclassmtpk_1_1core_1_1ThreadPool_html_a74055a560f9b8a2937ccbd652eb8b8a8"><div class="ttname"><a href="classmtpk_1_1core_1_1ThreadPool.html#a74055a560f9b8a2937ccbd652eb8b8a8">mtpk::core::ThreadPool::enqueue</a></div><div class="ttdeci">auto enqueue(F &amp;&amp;f, Args &amp;&amp;... args) -&gt; std::future&lt; typename std::result_of&lt; F(Args...)&gt;::type &gt;</div><div class="ttdoc">Enqueues a task to the thread pool.</div><div class="ttdef"><b>Definition:</b> <a href="threadpool_8hpp_source.html#l00147">threadpool.hpp:147</a></div></div>
<div class="ttc" id="aprime__test_8cpp_html_ae705b16e0f91ad04a0d1892bd85d3b5b"><div class="ttname"><a href="prime__test_8cpp.html#ae705b16e0f91ad04a0d1892bd85d3b5b">prim</a></div><div class="ttdeci">mtpk::PrimalityTest prim</div><div class="ttdef"><b>Definition:</b> <a href="prime__test_8cpp_source.html#l00059">prime_test.cpp:59</a></div></div>
<div class="ttc" id="aprimes_8cpp_html_a14003875a6c31e1f9d1bf4b153878e3e"><div class="ttname"><a href="primes_8cpp.html#a14003875a6c31e1f9d1bf4b153878e3e">testing_miller</a></div><div class="ttdeci">void testing_miller(std::vector&lt; int64_t &gt; nums)</div><div class="ttdef"><b>Definition:</b> <a href="primes_8cpp_source.html#l00016">primes.cpp:16</a></div></div>
<div class="ttc" id="aprimes_8cpp_html_a286bd143d8ec3bf5f09b6dc36803c093"><div class="ttname"><a href="primes_8cpp.html#a286bd143d8ec3bf5f09b6dc36803c093">testing_new_miller</a></div><div class="ttdeci">void testing_new_miller(std::vector&lt; int64_t &gt; nums)</div><div class="ttdef"><b>Definition:</b> <a href="primes_8cpp_source.html#l00076">primes.cpp:76</a></div></div>
<div class="ttc" id="aprimes_8cpp_html_a33daa0145dde696a317ebf44cde84295"><div class="ttname"><a href="primes_8cpp.html#a33daa0145dde696a317ebf44cde84295">testing_miller_thread</a></div><div class="ttdeci">void testing_miller_thread(std::vector&lt; int64_t &gt; nums)</div><div class="ttdef"><b>Definition:</b> <a href="primes_8cpp_source.html#l00041">primes.cpp:41</a></div></div>
<div class="ttc" id="aprimes_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="primes_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="primes_8cpp_source.html#l00116">primes.cpp:116</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
